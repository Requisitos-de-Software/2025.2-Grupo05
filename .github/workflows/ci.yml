name: Deploy GitHub Pages

# Gatilho simplificado: roda apenas em push para a branch 'main'
on:
  push:
    branches: [main]

jobs:
  deploy-pages:
    name: "ğŸš€ Deploy Pages"
    runs-on: ubuntu-latest

    steps:
      # Passo 1: Checkout do cÃ³digo
      # fetch-depth: 0 garante que todo o histÃ³rico Git seja baixado
      - name: ğŸ”¦ Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      # Passo 2: Configurar o ambiente Python
      - name: ğŸ§° Setup python
        uses: actions/setup-python@v5
        with:
          python-version: "3.12"

      # Passo 3: Cache de dependÃªncias pip para velocidade
      # Armazena pacotes em cache para acelerar builds futuros
      - name: âš¡ Cache pip
        uses: actions/cache@v4
        with:
          path: ~/.cache/pip
          key: ${{ runner.os }}-pip-${{ hashFiles('**/requirements.txt') }}
          restore-keys: |
            ${{ runner.os }}-pip-

      # Passo 4: Instalar dependÃªncias (usarÃ¡ o cache se disponÃ­vel)
      - name: ğŸ’¾ Instalar dependÃªncias
        run: |
          pip install -r requirements.txt

      # Passo 5: Fazer o deploy no GitHub Pages
      # A condiÃ§Ã£o 'if' Ã© uma seguranÃ§a extra
      - name: ğŸš€ Deploy to GitHub Pages
        if: github.event_name == 'push'
        run: |
          echo "ğŸ“š Fazendo deploy da documentaÃ§Ã£o..."
          # --force: ForÃ§a o push para a branch gh-pages
          # --clean: Remove arquivos antigos da branch gh-pages
          mkdocs gh-deploy --force --clean --verbose
        env:
          # Token necessÃ¡rio para autenticar o push na branch gh-pages
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
